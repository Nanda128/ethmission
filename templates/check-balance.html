<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Check Balance - EthMission</title>
    <link rel="stylesheet" href="../src/css/styles.css">
    <link rel="icon" href="../assets/static/favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/web3@4.16.0/dist/web3.min.js"></script>
    <script src="../src/js/common.js" type="module"></script>
    <script src="../src/js/config.js" type="module"></script>
</head>
<body>
<div class="container">
    <header>
        <h1>ğŸŸï¸ EthMissionâ€”A Web3 Ticketing DApp</h1>
        <nav>
          <ul>
            <li><a href="../index.html">Home</a></li>
            <li><a href="create-wallet.html">Create Wallet</a></li>
            <li><a href="check-balance.html">Check Balance</a></li>
            <li><a href="buy-ticket.html">Buy Ticket</a></li>
            <li><a href="transfer-ticket.html">Transfer Ticket</a></li>
            <li><a href="create-event.html" class="active">Create Event</a></li>
            <li><a href="event-entry.html">Event Entry</a></li>
          </ul>
        </nav>
      </header>

    <main>
        <section>
            <h2>Check Balances</h2>
            <p>View your ETH and ticket token balances.</p>

            <div class="connect-wallet-section">
                <h3>Connect Wallet First</h3>
                <div class="wallet-connection-options">
                    <button id="connectMetamaskButton">ğŸ¦Š Connect with MetaMask</button>
                    <div class="option-divider"><span>OR</span></div>
                    <div class="wallet-upload-section">
                        <label for="walletFileInput" class="file-input-label">ğŸ“‚ Upload Wallet JSON</label>
                        <input type="file" id="walletFileInput" accept=".json">
                        <div id="uploadedWalletInfo" class="info" style="display: none;"></div>
                        <div id="walletDecryptSection" style="display: none;">
                            <label for="walletPassword">Enter password to decrypt wallet:</label>
                            <input type="password" id="walletPassword" placeholder="Wallet password">
                            <button id="connectUploadedWalletButton">ğŸ”“ Connect with Uploaded Wallet</button>
                        </div>
                    </div>
                </div>
                <div class="wallet-connected-message" style="display: none;">âœ… Connected!</div>
                <div id="walletAddress" class="info"></div>
            </div>

            <div class="role-selection-section">
                <h3>Select Your Role</h3>
                <div class="role-options">
                    <label class="role-option">
                        <input type="radio" name="userRole" value="Attendee" checked>
                        <span>Event Attendee</span>
                    </label>
                    <label class="role-option">
                        <input type="radio" name="userRole" value="Doorman">
                        <span>Doorman</span>
                    </label>
                    <label class="role-option">
                        <input type="radio" name="userRole" value="Venue">
                        <span>Venue Manager</span>
                    </label>
                    <label class="role-option">
                        <input type="radio" name="userRole" value="Admin">
                        <span>Admin</span>
                    </label>
                </div>
            </div>

            <div id="AttendeeSection" class="role-section">
                <h3>Your Balances</h3>
                <button id="checkBalanceButton">ğŸ” Check My Balances</button>
                <div id="balances" class="info"></div>
            </div>

            <div id="DoormanSection" class="role-section" style="display: none;">
                <h3>Verify Ticket Holder</h3>
                <label for="verifyAddress">Enter Wallet Address:</label>
                <input type="text" id="verifyAddress" placeholder="0x...">
                <button id="verifyTicketButton">ğŸ” Verify Ticket</button>
                <div id="verificationResult" class="info"></div>
            </div>

            <div id="VenueManagerSection" class="role-section" style="display: none;">
                <h3>Venue Management</h3>
                <button id="checkVenueStatsButton">ğŸ“Š View Ticket Distribution</button>
                <div id="venueStats" class="info"></div>
            </div>

            <div id = "AdminSection" class="role-section" style ="display: none;">
                <h3>Register New Venue or Doorman</h3>
                <label for="roleType">Role Type:</label>
                <select id="roleType">
                    <option value="Venue">Venue Manager</option>
                    <option value="Doorman">Doorman</option>
                </select>
                <label for="roleName">Name:</label>
                <input type="text" id="roleName" placeholder="Enter name">
                <label for="roleAddress">Wallet Address:</label>
                <input type="text" id="roleAddress" placeholder="0x...">
                <button id="registerRoleButton">ğŸ“ Register</button>
                <div id="registeredRoles" class="info"></div>
            </div>
        </section>
    </main>

    <div id="output" class="output"></div>

    <footer>
        <p>Â©(not really) 2025 EthMissionâ€”A Web3 Ticketing DApp</p>
    </footer>
</div>

<script type="module">
    import { setupWalletConnectors } from '../src/js/wallet.js';
    import { setupBalanceChecking, setupRoleSelection } from '../src/js/balance.js';

    document.addEventListener('DOMContentLoaded', () => {
        setupWalletConnectors();
        setupBalanceChecking();
        setupRoleSelection();
    });
</script>
</body>
</html>
